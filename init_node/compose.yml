version: "3.8"
services:
    chordNode:
      build:
         context: ../chordNode/
         dockerfile: Dockerfile
      image: chord_node:v1.0
      networks: 
        - chord
      deploy:
        replicas: "${NODE_REPLICAS}"
        resources:
          limits:
            cpus: '0.5'
            memory: 100m
      entrypoint: ["watchexec","-f","chordNode.py","-c","-r", "--","python3","./chordNode.py"]
      environment:
        - FT_SIZE=${IDENT_SPACE_EXP}
      tty: true
      volumes: 
          - ChordNodeData:/opt/chordNode/Data/
          - ChordNodeCode:/opt/chordNode/

networks: 
    chord: 
        name: chord-net
        external: true

volumes:
    ChordNodeData:
        external: true
    ChordNodeCode:
        name: ChordNodeCode
        driver: local
        driver_opts:
            o: bind
            type: none
            device: /home/up1072498/Projects/Chord/init_node/ChordNodeCode